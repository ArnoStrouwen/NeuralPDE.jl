<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Full Kolmogorov PDE Solver · NeuralPDE.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://neuralpde.sciml.ai/stable/solvers/full_kolmogorov/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Scientific Machine Learning (SciML) for Partial Differential Equations</a></li><li><span class="tocitem">Physics-Informed Neural Network Tutorials</span><ul><li><a class="tocitem" href="../../pinn/poisson/">Poisson Equation</a></li><li><a class="tocitem" href="../../pinn/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../pinn/2D/">2-dimensional PDEs with GPU</a></li><li><a class="tocitem" href="../../pinn/system/">Systems of PDEs</a></li><li><a class="tocitem" href="../../pinn/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../pinn/low_level/">1-D Burgers&#39; Equation With Low-Level API</a></li><li><a class="tocitem" href="../../pinn/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../pinn/fp/">Fokker-Planck Equation</a></li><li><a class="tocitem" href="../../pinn/parm_estim/">Optimising Parameters of a Lorenz System</a></li><li><a class="tocitem" href="../../pinn/heterogeneous/">Differential Equations with Heterogeneous Inputs</a></li><li><a class="tocitem" href="../../pinn/integro_diff/">Integro Differential Equations</a></li><li><a class="tocitem" href="../../pinn/debugging/">Debugging PINN Solutions</a></li><li><a class="tocitem" href="../../pinn/neural_adapter/">Transfer Learning with Neural Adapter</a></li></ul></li><li><span class="tocitem">Specialized Neural PDE Tutorials</span><ul><li><a class="tocitem" href="../../examples/100_HJB/">Solving a 100-dimensional Hamilton-Jacobi-Bellman Equation</a></li><li><a class="tocitem" href="../../examples/blackscholes/">Solving the 100-dimensional Black-Scholes-Barenblatt Equation</a></li><li><a class="tocitem" href="../../examples/kolmogorovbackwards/">Solving Kolmogorov Equations with Neural Networks</a></li><li><a class="tocitem" href="../../examples/optimal_stopping_american/">Optimal Stopping Times of American Options</a></li></ul></li><li><span class="tocitem">Specialized Neural ODE Tutorials</span><ul><li><a class="tocitem" href="../../examples/ode/">Solving ODEs with Neural Networks</a></li><li><a class="tocitem" href="../../examples/nnrode_example/">Solving Random Ordinary Differential Equations</a></li></ul></li><li><span class="tocitem">API Documentation</span><ul><li><a class="tocitem" href="../pinns/">Physics-Informed Neural Networks</a></li><li><a class="tocitem" href="../deep_fbsde/">Deep Forward-Backwards SDEs for Terminal Parabolic PDEs</a></li><li><a class="tocitem" href="../kolmogorovbackwards_solver/">Neural Network Solvers for Kolmogorov Backwards Equations</a></li><li><a class="tocitem" href="../optimal_stopping/">Neural Network Solvers for Optimal Stopping Time Problems</a></li><li><a class="tocitem" href="../ode/">ODE-Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../nnrode/">Random Ordinary Differential Equation Specialized Physics-Informed Neural Solver</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Full Kolmogorov PDE Solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Full Kolmogorov PDE Solver</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/solvers/full_kolmogorov.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Full-Kolmogorov-PDE-Solver"><a class="docs-heading-anchor" href="#Full-Kolmogorov-PDE-Solver">Full Kolmogorov PDE Solver</a><a id="Full-Kolmogorov-PDE-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Kolmogorov-PDE-Solver" title="Permalink"></a></h1><p>The full Kolmogorov PDE solver obtains the complete solution of a family of γ γ-parameterised Kolmogorov PDE of the form, <img src="https://raw.githubusercontent.com/ashutosh-b-b/github-doc-images/master/full_kolmogorov.png" alt/></p><p>The  <code>σ</code> and <code>μ</code> are also parameterised by <code>γ</code>. Thus before we define the neural network solution, we figure out the dimensions required. Let&#39;s say the domain of the PDE is <img src="https://raw.githubusercontent.com/ashutosh-b-b/github-doc-images/master/domain_full_kolm.png" alt/> The first dimension is taken by <code>t</code> , and the next <code>d</code> dimensions are taken by <code>x</code>&lt;sup&gt;d&lt;/sup&gt; i.e. spatial region. The next dimensions are for <code>γ</code> that parameterise the  <code>σ</code>, <code>μ</code> and <code>phi</code> (the initial condition). And thus, <img src="https://raw.githubusercontent.com/ashutosh-b-b/github-doc-images/master/param_img.png" alt/> [a&lt;sub&gt;1&lt;/sub&gt; | a&lt;sub&gt;2&lt;/sub&gt; ....  | a&lt;sub&gt;n&lt;/sub&gt;]   represents  horizontal concatenation. So for defining <code>γ</code> we will be defining :</p><ul><li><code>σ_γ</code> can be atmost d + 1 matrices with dimensions <code>d x d</code>  or <code>nothing</code>.</li><li><code>μ_γ</code>  can comprise of either a<code>d x d</code> matrix and a matrix of dimensions <code>d x 1</code> or both, or nothing.</li><li><code>phi_γ</code> can be a matrix with dimensions <code>k x 1</code>.</li></ul><p>We define the prototypes for the above parameters:</p><ul><li><code>γ_sigma_prototype</code>  should be a 3 dimensional matrix with first two dimensions d and d, and the last dimension should be number of matrices (at most d + 1) or it can be <code>nothing</code>.</li><li><code>γ_mu_prototype</code>  should comprise of 2 matrices one with dimensions <code>d x d</code>and other with dimensions <code>d x 1</code>. So we define <code>γ_mu_prototype</code> as <code>(matrix1 , matrix2)</code> we put <code>nothing</code> in the place if we dont require either of them. Or if we dont want it parameterised, we define,  <code>γ_mu_prototype</code> as <code>nothing</code></li><li><code>γ_phi_prototype</code> should be a matrix with <code>k x 1</code> dimensions.</li></ul><p>Now lets define a test problem,</p><p>We start by defining the dimension <code>d</code> of the solution and the prototypes for the problem.</p><pre><code class="language-julia hljs">d = 1
γ_mu_prototype = nothing
γ_sigma_prototype = zeros(d , d , 1)
γ_phi_prototype = nothing</code></pre><p>And now the neural network solution with the number of dimensions we require at input.</p><pre><code class="language-julia hljs">m = Chain(Dense(3 , 16, elu),Dense(16, 16, elu) , Dense(16 , 5 , elu) , Dense(5 , 1))</code></pre><p>And then we write the domains of <code>t</code> , <code>x</code>, <code>γ_sigma</code>, <code>γ_mu</code> and <code>γ_phi</code>. And thus we use <code>KolmogorovParamDomain</code> to pass the domains of   <code>γ_sigma</code>, <code>γ_mu</code> and <code>γ_phi</code> as arguments, respectively.</p><pre><code class="language-julia hljs">tspan = (0.00 , 1.00)
xspan = (0.00 , 3.00)
y_domain = KolmogorovParamDomain((0.00 , 2.00) , (0.00 , 0.00) , (0.00 , 0.00) )</code></pre><p>The functions <code>σ(x , γ_sigma)</code> where  and <code>μ(x , γ_mu1, γ_mu2)</code> (<code>γ_mu1</code> is the d x d x 1 matrix and <code>γ_mu2</code> is a d x 1 x 1 matrix)</p><pre><code class="language-julia hljs">g(x , γ_sigma) = γ_sigma[: , : , 1] #the σ(x , γ_sigma)
f(x , γ_mu_1 ,γ_mu_2 ) = [0.00] # the μ(x , γ_mu1, γ_mu2)</code></pre><p>And then we define the function <code>phi(x , γ_phi)</code> where <code>γ_phi</code> is a matrix with <code>k x 1 x trajectories</code> . Thus the function should return an <code>array</code> with dimensions <code>1 x trajectories</code>.</p><pre><code class="language-julia hljs">function phi(x , y_phi)
  x.^2
end</code></pre><p>We define the <code>dt</code> , <code>dx</code> and <code>dy</code> for the equation,</p><pre><code class="language-julia hljs">dt = 0.01
dx = 0.01
dy = 0.01</code></pre><p>And then we finally define the optimiser, the algorithms for SDE solution and ensemble simulation.</p><pre><code class="language-julia hljs">opt = Flux.ADAM(1e-2)
sdealg = EM()
ensemblealg = EnsembleThreads()</code></pre><p>Finally we define the <code>ParamKolmogorovPDEProblem</code> ,</p><pre><code class="language-julia hljs">prob = ParamKolmogorovPDEProblem(f , g , phi , xspan , tspan , d  , y_domain  ; Y_sigma_prototype = γ_sigma_prototype)
sol = solve(prob, NNParamKolmogorov(m,opt , sdealg,ensemblealg) , verbose = true, dt = 0.01,
            abstol=1e-10, dx = 0.01 , trajectories = trajectories ,  maxiters = 150 , use_gpu = false)</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Thursday 24 March 2022 10:47">Thursday 24 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
